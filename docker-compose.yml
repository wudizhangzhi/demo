version: "2" 
services:
    web:
        build: ./web/
        command: bash -c "python manage.py makemigrations &&
                          python manage.py migrate &&
                          python manage.py collectstatic &&
                          uwsgi --ini uwsgi.conf"
        ports:
            - "8000:8000"
        volumes:
            - /main
            - /log
        links:
            - mysql 
            - redis
    
    mysql:
        image: mysql:5.7.19 
        volumes:
            - /var/lib/mysql
        environment:
            - MYSQL_ROOT_PASSWORD=password

    redis:
        restart: always
        image: redis:latest
        volumes:
            - /data
